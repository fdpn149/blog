import{r as u,j as h}from"./index-Chn6-Wh6.js";import{s as r}from"./MathTools.module-D-v9u26r.js";import{u as a}from"./useTheme-C-uUH_g4.js";function m(s){let i=g(s);i=N(i),console.log(i);let e=w(i);console.log(e);const l=p(e);return console.log(l),l}function f(s){return s.length>1&&(s.length===2&&s[0]==="-"||(s=s.slice(0,s.length-1))),!isNaN(s)}class c{constructor(i,e,l,t){this.i=0,this.j=0,this.k=0,this.r=0,e===void 0||l===void 0||t===void 0?i.length>1?i[i.length-1]==="i"?this.i=Number(i.slice(0,i.length-1)):i[i.length-1]==="j"?this.j=Number(i.slice(0,i.length-1)):i[i.length-1]==="k"?this.k=Number(i.slice(0,i.length-1)):this.r=Number(i):this.r=Number(i):(this.r=Number(i),this.i=Number(e),this.j=Number(l),this.k=Number(t))}add(i){const e=this.r+i.r,l=this.i+i.i,t=this.j+i.j,n=this.k+i.k;return new c(e,l,t,n)}sub(i){const e=this.r-i.r,l=this.i-i.i,t=this.j-i.j,n=this.k-i.k;return new c(e,l,t,n)}mul(i){const e=this.r*i.r-this.i*i.i-this.j*i.j-this.k*i.k,l=this.r*i.i+this.i*i.r+this.j*i.k-this.k*i.j,t=this.r*i.j-this.i*i.k+this.j*i.r+this.k*i.i,n=this.r*i.k+this.i*i.j-this.j*i.i+this.k*i.r;return new c(e,l,t,n)}div(i){const e=i.r*i.r+i.i*i.i+i.j*i.j+i.k*i.k,l=new c(i.r/e,-i.i/e,-i.j/e,-i.k/e);return this.mul(l)}toString(){let i="";return this.r!==0&&(i+=this.r),this.i!==0&&(i+=(i.length===0||this.i<0?"":"+")+this.i+"i"),this.j!==0&&(i+=(i.length===0||this.j<0?"":"+")+this.j+"j"),this.k!==0&&(i+=(i.length===0||this.k<0?"":"+")+this.k+"k"),i}}function p(s){const i=[];for(let e=0;e<s.length;e++)if(f(s[e]))i.push(new c(s[e]));else switch(s[e]){case"+":{const l=i[i.length-2].add(i[i.length-1]);i[i.length-2]=l,i.pop();break}case"-":{const l=i[i.length-2].sub(i[i.length-1]);i[i.length-2]=l,i.pop();break}case"*":{const l=i[i.length-2].mul(i[i.length-1]);i[i.length-2]=l,i.pop();break}case"/":{const l=i[i.length-2].div(i[i.length-1]);i[i.length-2]=l,i.pop();break}}return i[0].toString()}function j(s){switch(s){case"+":case"-":return 1;case"*":case"/":return 2;case"(":return 0}}function w(s){let i=[],e=[];s.splice(0,0,"("),s.push(")");for(let l=0;l<s.length;l++){const t=s[l];if(f(t))i.push(t);else if(t==="(")e.push("(");else if(t===")"){for(;e[e.length-1]!=="(";)i.push(e.pop());e.pop()}else{for(;e.length>0&&j(e[e.length-1])>=j(t);)i.push(e.pop());e.push(t)}}return i}function g(s){let i=[],e=0,l=!1;for(let t=0;t<s.length;t++)if(s[t]==="("||s[t]===")"||s[t]==="."||s[t]==="+"||s[t]==="-"||s[t]==="*"||s[t]==="/"||s[t]==="i"||s[t]==="j"||s[t]==="k")l&&(i.push(e),l=!1,e=0),i.push(s[t]);else if(!isNaN(s[t]))l===!1&&(l=!0),e=e*10+Number(s[t]);else return;return l&&i.push(e),i}function N(s){for(let i=0;i<s.length;i++)s[i]==="-"?i+1<s.length&&(i-1<0||!f(s[i-1])&&s[i-1]!==")")&&(s[i+1]==="i"||s[i+1]==="j"||s[i+1]==="k"?(s[i+1]="-1"+s[i+1],s.splice(i,1),i--):isNaN(s[i+1])||(s[i+1]="-"+s[i+1],s.splice(i,1),i--)):isNaN(s[i])?s[i]===")"?i+1<s.length&&(!isNaN(s[i+1])||s[i+1]==="i"||s[i+1]==="j"||s[i+1]==="k"||s[i+1]==="(")&&(s.splice(i+1,0,"*"),i++):(s[i]==="i"||s[i]==="j"||s[i]==="k")&&(s[i]="1"+s[i]):i+1<s.length&&(s[i+1]==="i"||s[i+1]==="j"||s[i+1]==="k"?(s[i+1]=s[i]+s[i+1],s.splice(i,1),i--):s[i+1]==="("?(s.splice(i+1,0,"*"),i++):i+2<s.length&&s[i+1]==="."&&!isNaN(s[i+2])&&(s[i+2]=s[i]+"."+s[i+2],s.splice(i,2),i--));return s}function v(){a();const[s,i]=u.useState(""),[e,l]=u.useState(0);return h.jsxs("section",{className:r.mathSection,children:[h.jsx("h3",{children:"算式"}),h.jsx("textarea",{className:r.textarea,value:s,onChange:t=>{i(t.target.value)}}),h.jsx("br",{}),h.jsx("br",{}),h.jsx("button",{className:r.button,onClick:()=>{try{l(m(s))}catch{l("無法計算")}},children:"計算"}),h.jsx("h3",{children:"計算結果"}),h.jsx("div",{className:r.resultBox,children:h.jsx("p",{children:e})})]})}export{v as default};

(function(){"use strict";class m{constructor(...e){e.length===1?(this.re=Number(e[0].re),this.im=Number(e[0].im)):e.length===2&&(this.re=Number(e[0]),this.im=Number(e[1]))}add(e){if(typeof e=="number")var t=this.re+e,i=this.im;else var t=this.re+e.re,i=this.im+e.im;return new m(t,i)}sub(e){if(typeof e=="number")var t=this.re-e,i=this.im;else var t=this.re-e.re,i=this.im-e.im;return new m(t,i)}mul(e){if(typeof e=="number")var t=this.re*e,i=this.im*e;else var t=this.re*e.re-this.im*e.im,i=this.re*e.im+this.im*e.re;return new m(t,i)}div(e){if(typeof e=="number")var t=this.re/e,i=this.im/e;else{const r=e.re*e.re+e.im*e.im;var t=(this.re*e.re+this.im*e.im)/r,i=(this.im*e.re-this.re*e.im)/r}return new m(t,i)}toString(){console.log(`${this.re}+${this.im}i`)}isInteger(){return Number.isInteger(this.re)&&Number.isInteger(this.im)}isZero(){return this.re===0&this.im===0}}function f(n,e,t){let i=k(t),r={re:{neg:!1,int:[0],dec:[0]},im:{neg:!1,int:[0],dec:[0]}};switch(n){case"pos":{switch(i){case"pos":{let s=a(t.re%1),l=t.re|0;o(r,n,e,s,l);break}case"neg":{r.re.neg=!0;let s=-a(t.re%1),l=-(t.re|0);o(r,n,e,s,l);break}case"cpl":{let s={re:t.re,im:0},l={re:t.im,im:0};r.re=f(n,e,s).re,r.im=f(n,e,l).re;break}}break}case"neg":{switch(i){case"pos":case"neg":{let s=a(t.re%1),l=t.re|0;o(r,n,e,s,l);break}case"cpl":{let s={re:t.re,im:0},l={re:t.im,im:0};r.re=f(n,e,s).re,r.im=f(n,e,l).re;break}}break}case"bal":{switch(i){case"pos":case"neg":{let s=a(t.re%1),l=t.re|0;o(r,n,e,s,l);break}case"cpl":{let s={re:t.re,im:0},l={re:t.im,im:0};r.re=f(n,e,s).re,r.im=f(n,e,l).re;break}}break}case"bij":{switch(i){case"pos":{let s=a(t.re%1),l=t.re|0;o(r,n,e,s,l);break}case"neg":{r.re.neg=!0;let s=-a(t.re%1),l=-(t.re|0);o(r,n,e,s,l);break}case"cpl":{let s={re:t.re,im:0},l={re:t.im,im:0};r.re=f(n,e,s).re,r.im=f(n,e,l).re;break}}break}case"ima":{let s={re:t.re,im:0},l={re:t.im/e.im,im:0};e={re:-e.im*e.im,im:0};let u=f("neg",e,s).re,h=f("neg",e,l).re;r.re.int=[],r.re.dec=[],h.int.length===1&&h.int[0]===0&&(h.int=[]),u.dec.length===1&&u.dec[0]===0&&(u.dec=[]);let g=0,c=0;for(;c<u.int.length||c<h.int.length;)g%2===0?c<u.int.length?r.re.int.push(u.int[c]):r.re.int.push(0):c<h.int.length?r.re.int.push(h.int[c]):c+1<u.int.length&&r.re.int.push(0),g++,c=Math.floor(g/2);for(g=0,c=0;g<100&&(c<u.dec.length||c<h.dec.length);)g%2===0?c<h.dec.length?r.re.dec.push(h.dec[c]):r.re.dec.push(0):c<u.dec.length?r.re.dec.push(u.dec[c]):c+1<h.dec.length&&r.re.dec.push(0),g++,c=Math.floor(g/2);break}case"cpl":{let s=new m(e),l=new m(t),u=d(s,l);u.length>0&&(r.re.int=u);break}case"dec":{switch(i){case"pos":{let s=v(e.re,t.re);r.re={...r.re,...s};break}case"neg":{r.re.neg=!0;let s=v(e.re,-t.re);r.re={...r.re,...s};break}case"cpl":{let s={re:t.re,im:0},l={re:t.im,im:0};r.re=f(n,e,s).re,r.im=f(n,e,l).re;break}}break}}return r}function o(n,e,t,i,r){let s=b(e,t.re,i);r+=s[0],s.shift();let l=j(e,t.re,r);l.length>0&&(n.re.int=l),s.length>0&&(n.re.dec=s)}function k(n){return n.im!==0?"cpl":n.re<0?"neg":"pos"}function p(n,e){switch(n){case"neg":return(-e-1)/(e*e-1);case"bal":return .5;case"bij":return e}return e}function M(n,e){switch(n){case"bal":return-.5;case"bij":return 1/(e-1)}return 0}function w(n,e,t,i,r){switch(n){case"pos":return[0,i];case"neg":return i>e?[1,a(i-1)]:[0,i];case"bal":return i>=e?[1,a(i-1)]:i<t?[-1,a(i+1)]:[0,i];case"bij":if(i<t)return i===0&&r<=e?[0,i]:[-1,a(i+1)]}return[0,i]}function b(n,e,t){let i=0;const r=[];let s=p(n,e),l=M(n,e),u=w(n,s,l,t,0);r.push(u[0]);let h=u[1];for(;i<100&&h!==0;){let g=a(h*e),c=g|0;h=a(g%1),u=w(n,s,l,h,c),c+=u[0],h=u[1],r.push(c),i++}return r}function N(n,e){switch(n){case"pos":case"neg":return 0;case"bal":return-(Math.abs(e)-1)/2;case"bij":return 1}return 0}function j(n,e,t){const i=[];let r=t,s=N(n,e),l;for(;r!==0;){let u=s-1;do u++,l=(r-u)/e;while(a(l%1)!==0);r=l|0,i.push(u)}return i}function v(n,e){let t=Math.floor(Math.log(e)/Math.log(n)),i=t,r=1;for(;i>0;)r*=n,i--;for(;i<0;)r/=n,i++;const s={int:[],dec:[]};let l=Math.ceil(n)-1,u=e;for(;t>=-100&&u>0;){for(i=1;i<=l+1;i++)if(i*r>u){i--,t<0?s.dec.push(i):s.int.unshift(i),u-=i*r;break}t--,r/=n}return s.int.length===0&&(s.int=[0]),s.dec.length===0&&(s.dec=[0]),s}function d(n,e){const t=[];let i=e;const r=n.re*n.re+n.im*n.im;let s;for(;!i.isZero();){let l=0;do s=i.sub(l).div(n),l++;while(l<r&&!s.isInteger());i=s,t.push(l-1)}return t}function a(n){return n<0?(n=-n,Number(-n.toFixed(12))):Number(n.toFixed(12))}self.onmessage=n=>{const{type:e,base:t,decimal:i}=n.data;try{const r=f(e,t,i);self.postMessage({success:!0,result:r})}catch(r){self.postMessage({success:!1,error:r.message})}}})();
